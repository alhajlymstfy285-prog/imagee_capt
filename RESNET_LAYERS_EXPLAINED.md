# Ø´Ø±Ø­ Ø·Ø¨Ù‚Ø§Øª ResNet50 Ø¨Ø§Ù„ØªÙØµÙŠÙ„

## ğŸ—ï¸ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ÙƒØ§Ù…Ù„Ø©

```
ResNet50 Architecture:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Input Image: (224, 224, 3)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ conv1: 7Ã—7 conv, 64 filters, stride=2                              â”‚
â”‚ Output: (112, 112, 64)                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ maxpool: 3Ã—3, stride=2                                              â”‚
â”‚ Output: (56, 56, 64)                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ layer1: 3 Bottleneck blocks                                         â”‚
â”‚ Output: (56, 56, 256)                                               â”‚
â”‚ - Low-level features (edges, textures)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ layer2: 4 Bottleneck blocks                                         â”‚
â”‚ Output: (28, 28, 512)                                               â”‚
â”‚ - Mid-level features (shapes, patterns)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ layer3: 6 Bottleneck blocks                                         â”‚
â”‚ Output: (14, 14, 1024)                                              â”‚
â”‚ - High-level features (parts, objects)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ layer4: 3 Bottleneck blocks                    â† Ù†Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§!       â”‚
â”‚ Output: (7, 7, 2048)                                                â”‚
â”‚ - Very high-level semantic features                                â”‚
â”‚ - Rich representation for image understanding                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ avgpool: Global Average Pooling                                    â”‚
â”‚ Output: (1, 1, 2048)                                                â”‚
â”‚ - Ù†Ø­Ù† Ù„Ø§ Ù†Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§! (ÙŠÙÙ‚Ø¯ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙƒØ§Ù†ÙŠØ©)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ fc: Fully Connected Layer                                           â”‚
â”‚ Output: (1000,) - ImageNet classes                                 â”‚
â”‚ - Ù†Ø­Ù† Ù„Ø§ Ù†Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§!                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Ù„Ù…Ø§Ø°Ø§ Ù†Ø³ØªØ®Ø¯Ù… layer4ØŸ

### 1. Spatial Information (Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ÙƒØ§Ù†ÙŠØ©)

```python
# layer4 output: (N, 2048, 7, 7)
#                     â†‘      â†‘
#                  channels  spatial grid

# ÙƒÙ„ Ø®Ù„ÙŠØ© ÙÙŠ Ø§Ù„Ù€ 7Ã—7 ØªÙ…Ø«Ù„ Ù…Ù†Ø·Ù‚Ø© Ù…Ù† Ø§Ù„ØµÙˆØ±Ø©:
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ 0,0 â”‚ 0,1 â”‚ 0,2 â”‚ 0,3 â”‚ 0,4 â”‚ 0,5 â”‚ 0,6 â”‚  â† ÙƒÙ„ Ø®Ù„ÙŠØ© = 2048 features
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ 1,0 â”‚ 1,1 â”‚ 1,2 â”‚ 1,3 â”‚ 1,4 â”‚ 1,5 â”‚ 1,6 â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ 2,0 â”‚ 2,1 â”‚ 2,2 â”‚ 2,3 â”‚ 2,4 â”‚ 2,5 â”‚ 2,6 â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ 3,0 â”‚ 3,1 â”‚ 3,2 â”‚ 3,3 â”‚ 3,4 â”‚ 3,5 â”‚ 3,6 â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ 4,0 â”‚ 4,1 â”‚ 4,2 â”‚ 4,3 â”‚ 4,4 â”‚ 4,5 â”‚ 4,6 â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ 5,0 â”‚ 5,1 â”‚ 5,2 â”‚ 5,3 â”‚ 5,4 â”‚ 5,5 â”‚ 5,6 â”‚
â”œâ”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”¤
â”‚ 6,0 â”‚ 6,1 â”‚ 6,2 â”‚ 6,3 â”‚ 6,4 â”‚ 6,5 â”‚ 6,6 â”‚
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜

# Ù…Ø«Ø§Ù„: Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ØµÙˆØ±Ø© ÙÙŠÙ‡Ø§ ÙƒÙ„Ø¨ ÙÙŠ Ø§Ù„ÙŠØ³Ø§Ø± ÙˆÙ‚Ø·Ø© ÙÙŠ Ø§Ù„ÙŠÙ…ÙŠÙ†
# Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„ÙŠØ³Ø±Ù‰ (0,0 - 0,3) Ø³ØªØ­ØªÙˆÙŠ features Ø§Ù„ÙƒÙ„Ø¨
# Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„ÙŠÙ…Ù†Ù‰ (0,4 - 0,6) Ø³ØªØ­ØªÙˆÙŠ features Ø§Ù„Ù‚Ø·Ø©
```

### 2. Rich Semantic Features

```python
# layer4 ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰:
- Object detection features (ÙƒÙ„Ø¨ØŒ Ù‚Ø·Ø©ØŒ Ø³ÙŠØ§Ø±Ø©)
- Scene understanding (Ø¯Ø§Ø®Ù„ØŒ Ø®Ø§Ø±Ø¬ØŒ Ø´Ø§Ø±Ø¹)
- Relationships (Ø´Ø®Øµ ÙŠØ±ÙƒØ¨ Ø¯Ø±Ø§Ø¬Ø©)
- Attributes (Ø£Ø­Ù…Ø±ØŒ ÙƒØ¨ÙŠØ±ØŒ ØµØºÙŠØ±)

# ÙƒÙ„ channel Ù…Ù† Ø§Ù„Ù€ 2048 ÙŠØªØ¹Ù„Ù… feature Ù…Ø¹ÙŠÙ†:
channel[0]   â†’ ÙŠÙƒØªØ´Ù "ÙˆØ¬ÙˆÙ‡"
channel[1]   â†’ ÙŠÙƒØªØ´Ù "Ø¹Ø¬Ù„Ø§Øª"
channel[2]   â†’ ÙŠÙƒØªØ´Ù "Ù†ÙˆØ§ÙØ°"
...
channel[2047] â†’ ÙŠÙƒØªØ´Ù "Ø³Ù…Ø§Ø¡"
```

### 3. Perfect for Attention

```python
# ÙÙŠ Attention LSTM:
# Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙŠØ³ØªØ·ÙŠØ¹ "ÙŠÙ†Ø¸Ø±" Ù„Ø£Ø¬Ø²Ø§Ø¡ Ù…Ø®ØªÙ„ÙØ© Ù…Ù† Ø§Ù„Ù€ 7Ã—7 grid

# Ù…Ø«Ø§Ù„: Ø¹Ù†Ø¯ ØªÙˆÙ„ÙŠØ¯ ÙƒÙ„Ù…Ø© "dog"
attention_weights = [
    [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1],
    [0.1, 0.8, 0.9, 0.7, 0.1, 0.1, 0.1],  â† ØªØ±ÙƒÙŠØ² Ø¹Ø§Ù„ÙŠ Ù‡Ù†Ø§
    [0.1, 0.7, 0.8, 0.6, 0.1, 0.1, 0.1],  â† (Ù…Ù†Ø·Ù‚Ø© Ø§Ù„ÙƒÙ„Ø¨)
    [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1],
    [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1],
    [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1],
    [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1],
]
```

## ğŸ“Š Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø·Ø¨Ù‚Ø§Øª

| Layer | Output Shape | Channels | Spatial | Features | Use Case |
|-------|-------------|----------|---------|----------|----------|
| layer1 | (56, 56, 256) | 256 | ÙƒØ¨ÙŠØ± | Low-level | âŒ ØªÙØ§ØµÙŠÙ„ ÙƒØ«ÙŠØ±Ø© |
| layer2 | (28, 28, 512) | 512 | Ù…ØªÙˆØ³Ø· | Mid-level | âš ï¸ Ù…Ù…ÙƒÙ† |
| layer3 | (14, 14, 1024) | 1024 | ØµØºÙŠØ± | High-level | âš ï¸ Ù…Ù…ÙƒÙ† |
| **layer4** | **(7, 7, 2048)** | **2048** | **Ù…Ù†Ø§Ø³Ø¨** | **Semantic** | **âœ… Ø§Ù„Ø£ÙØ¶Ù„** |
| avgpool | (1, 1, 2048) | 2048 | Ù„Ø§ ÙŠÙˆØ¬Ø¯ | Global | âŒ ÙÙ‚Ø¯ Ø§Ù„Ù…ÙƒØ§Ù† |

## ğŸ”¬ ØªØ¬Ø±Ø¨Ø© Ø¹Ù…Ù„ÙŠØ©

```python
import torch
import torchvision.models as models
from torchvision.models.feature_extraction import create_feature_extractor

# ØªØ­Ù…ÙŠÙ„ ResNet50
resnet = models.resnet50(pretrained=True)

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ features Ù…Ù† Ø·Ø¨Ù‚Ø§Øª Ù…Ø®ØªÙ„ÙØ©
extractor = create_feature_extractor(
    resnet,
    return_nodes={
        'layer1': 'layer1_out',
        'layer2': 'layer2_out',
        'layer3': 'layer3_out',
        'layer4': 'layer4_out',
    }
)

# ØµÙˆØ±Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©
image = torch.randn(1, 3, 224, 224)

# Ø§Ø³ØªØ®Ø±Ø§Ø¬ features
with torch.no_grad():
    features = extractor(image)

print("Layer outputs:")
for name, feat in features.items():
    print(f"{name}: {feat.shape}")

# Output:
# layer1_out: torch.Size([1, 256, 56, 56])
# layer2_out: torch.Size([1, 512, 28, 28])
# layer3_out: torch.Size([1, 1024, 14, 14])
# layer4_out: torch.Size([1, 2048, 7, 7])  â† Ù†Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§!
```

## ğŸ¨ ØªØµÙˆØ± Features

```python
# layer4 output: (1, 2048, 7, 7)

# ÙŠÙ…ÙƒÙ† ØªØµÙˆØ±Ù‡ ÙƒÙ€:
# - 49 Ù…ÙˆÙ‚Ø¹ Ù…ÙƒØ§Ù†ÙŠ (7Ã—7)
# - ÙƒÙ„ Ù…ÙˆÙ‚Ø¹ Ù„Ù‡ 2048 feature
# - ÙƒÙ„ feature ÙŠØµÙ Ø´ÙŠØ¡ Ù…Ø¹ÙŠÙ† ÙÙŠ ØªÙ„Ùƒ Ø§Ù„Ù…Ù†Ø·Ù‚Ø©

# Ù…Ø«Ø§Ù„: ØµÙˆØ±Ø© Ù„Ø´Ø®Øµ ÙŠØ±ÙƒØ¨ Ø¯Ø±Ø§Ø¬Ø©
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Sky    Sky    Sky    Sky    Sky   â”‚  â† layer4[0:2, :]
â”‚  Tree   Person  Person  Bike  Road â”‚  â† layer4[2:4, :]
â”‚  Grass  Wheel   Wheel   Road  Road â”‚  â† layer4[4:6, :]
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# ÙƒÙ„ Ø®Ù„ÙŠØ© ØªØ­ØªÙˆÙŠ 2048 features ØªØµÙ Ù…Ø­ØªÙˆØ§Ù‡Ø§
```

## ğŸ’¡ Ù„Ù…Ø§Ø°Ø§ Ù„ÙŠØ³ avgpoolØŸ

```python
# avgpool ÙŠØ­ÙˆÙ„ (7, 7, 2048) â†’ (1, 1, 2048)
# ÙŠÙÙ‚Ø¯ ÙƒÙ„ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…ÙƒØ§Ù†ÙŠØ©!

# Ù…Ø«Ø§Ù„:
Before avgpool: (7, 7, 2048)
â”Œâ”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”
â”‚ Dog â”‚ Cat â”‚ Sky â”‚  â† Ù†Ø¹Ø±Ù Ù…ÙƒØ§Ù† ÙƒÙ„ Ø´ÙŠØ¡
â””â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”˜

After avgpool: (1, 1, 2048)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dog+Cat+Sky mix â”‚  â† ÙÙ‚Ø¯Ù†Ø§ Ø§Ù„Ù…ÙƒØ§Ù†!
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

# Ù„Ù„Ù€ image captioningØŒ Ù†Ø­ØªØ§Ø¬ Ù†Ø¹Ø±Ù "ÙˆÙŠÙ†" ÙƒÙ„ Ø´ÙŠØ¡
# Ø¹Ø´Ø§Ù† Ù†Ù‚Ø¯Ø± Ù†ÙˆÙ„Ø¯ captions Ø¯Ù‚ÙŠÙ‚Ø©
```

## ğŸ¯ Ø§Ù„Ø®Ù„Ø§ØµØ©

Ù†Ø³ØªØ®Ø¯Ù… **layer4** Ù„Ø£Ù†Ù‡:

1. âœ… **Spatial grid** (7Ã—7) - Ù†Ø¹Ø±Ù Ù…ÙƒØ§Ù† ÙƒÙ„ Ø´ÙŠØ¡
2. âœ… **Rich features** (2048 channels) - Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ØºÙ†ÙŠØ©
3. âœ… **Semantic level** - ÙŠÙÙ‡Ù… objects Ùˆ scenes
4. âœ… **Perfect for attention** - ÙŠØ³Ù…Ø­ Ø¨Ø§Ù„ØªØ±ÙƒÙŠØ² Ø¹Ù„Ù‰ Ø£Ø¬Ø²Ø§Ø¡ Ù…Ø®ØªÙ„ÙØ©
5. âœ… **Pretrained** - Ù…Ø¯Ø±Ø¨ Ø¹Ù„Ù‰ ImageNet

**Ø§Ù„Ù†ØªÙŠØ¬Ø©**: Ø£ÙØ¶Ù„ features Ù„ØªÙˆÙ„ÙŠØ¯ captions Ø¯Ù‚ÙŠÙ‚Ø©! ğŸ‰
